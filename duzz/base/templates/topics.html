{% extends 'base.html' %}

{% block extrajs %}
<script src="{{ static('base/js/topics.js') }}"></script>
{% endblock %}

{% block maincontent %}
<span id="new-topic-button-container">
  <a href="#" id="new-topic-button" class="btn btn-primary btn-sm">New Topic</a>
</span>

<h1>Topics</h1>

<div id="new-topic-form">
  <form id="topic-form" action="{{ url('topic_add') }}" method="POST" role="form">
    {{ csrf() }}

    <div class="form-group">
      {{ field_with_attrs(topic_form.subject, placeholder="Τίτλος",
                          required="true", class="form-control") }}

    </div>
    <div class="form-group">
      {{ field_with_attrs(comment_form.text, placeholder="Σχόλιο",
                          required="true",
                          rows="2", class="form-control") }}

    </div>
    <div class="align-right">
      <input id="id_submit" type="submit" class="btn btn-success" value="Save">
    </div>
  </form>
</div>

<ul id="topic-list" class="list-group">
  {% for topic in topics %}
  <li class="list-group-item tc-item" data-id="{{ topic.id }}">
    <a class="item-link" href="{{ url('comments', topic.id) }}">
      <div>
        <img id="avatar" src="{{ topic.creator.get_avatar_url() }}">
        <span class="badge pull-right">{{ topic.comments.count() }}</span>
        <div id="creator">
          {{ topic.creator.full_name|default(topic.creator.email, true) }}
          <span id="datetime">on {{ topic.created.strftime('%d/%M/%Y') }}</span>
        </div>
        {{ topic.subject }}
      </div>
    </a>
  </li>
  {% endfor %}

</ul>

{% endblock %}
